---
const {
	title, // Le titre sera obligatoire sur chaque page
	description = "Le blog personnel de Valentin. Développement, tech et découvertes.",
	image = "/paysage-accueil.jpg",
} = Astro.props;

// On calcule l'URL "officielle" de la page actuelle pour Google
const canonicalURL = new URL(Astro.url.pathname, Astro.site);

import Analytics from "@vercel/analytics/astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
---

<!doctype html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link
			rel="icon"
			type="image/png"
			href="/favicon-96x96.png"
			sizes="96x96"
		/>
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link
			rel="apple-touch-icon"
			sizes="180x180"
			href="/apple-touch-icon.png"
		/>
		<link rel="manifest" href="/site.webmanifest" />
		<meta name="theme-color" content="#0d1b2a" />
		<meta name="generator" content={Astro.generator} />

		<link rel="canonical" href={canonicalURL} />
		<title>{title} | vbesse.com</title>
		<meta name="description" content={description} />

		<meta property="og:type" content="website" />
		<meta property="og:url" content={Astro.url} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={new URL(image, Astro.url)} />

		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={Astro.url} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content={new URL(image, Astro.url)} />

		<script is:inline>
			const theme = (() => {
				if (
					typeof localStorage !== "undefined" &&
					localStorage.getItem("theme")
				) {
					return localStorage.getItem("theme");
				}
				if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
					return "dark";
				}
				return "light";
			})();

			if (theme === "dark") {
				document.documentElement.classList.add("dark");
			} else {
				document.documentElement.classList.remove("dark");
			}

			window.localStorage.setItem("theme", theme);
		</script>
	</head>
	<body>
		<Header />
		<main>
			<slot />
		</main>
		<Footer />
		<Analytics />
	</body>
</html>

<style is:global>
	html,
	:root {
		/* Une palette élégante : Fond blanc cassé, texte anthracite, bleu électrique pour les liens */
		--bg-color: #ffffff;
		--text-color: #1a1a1a;
		--accent-color: #0070f3;
		--border-color: #eaeaea;
		--secondary-bg: #f5f5f5;
		--gray-light: #f4f4f4;
		--accent: #232946;
		--accent-light: #eebbc3;
		--accent-dark: #b8c1ec;
		--brand-primary: #0070f3;
		--text-muted: #666666; /* Gris moyen pour le mode clair */
		--code-bg: #f5f5f5; /* Fond pour les blocs de code inline */
	}

	html.dark {
		--bg-color: #0d1b2a; /* Ton bleu très sombre */
		--text-color: #e0e0e0;
		--accent-color: #4da3ff; /* Un bleu plus clair pour ressortir sur le noir */
		--border-color: #2d3b4f;
		--secondary-bg: #162a40;
		--text-muted: #a3a3a3; /* Gris clair pour le mode sombre */
		--code-bg: #1e293b; /* Fond sombre pour le code */
	}

	body {
		background-color: var(--bg-color);
		color: var(--text-color);
		font-family:
			"Inter Variable",
			-apple-system,
			BlinkMacSystemFont,
			"Segoe UI",
			Roboto,
			Oxygen,
			Ubuntu,
			Cantarell,
			"Open Sans",
			"Helvetica Neue",
			sans-serif;
		line-height: 1.6;
		margin: 0;
		padding: 0;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		transition:
			background-color 0.3s ease,
			color 0.3s ease;
	}

	main {
		max-width: 720px;
		margin: 0 auto;
		padding: 2rem 1rem;
	}

	a {
		color: var(--accent-color);
		text-decoration: none;
	}

	a:hover {
		text-decoration: underline;
	}

	header {
		margin: 0;
		padding: 0 1em;
		background: white;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
		position: relative;
		top: 0;
		z-index: 10;
	}

	nav {
		display: flex;
		align-items: center;
		justify-content: space-between;
		max-width: 1000px;
		margin: 0 auto;
		padding: 1rem 0;
	}

	.site-title {
		font-size: 1.3rem;
		font-weight: 800;
		color: var(--text-color);
		text-decoration: none;
		letter-spacing: -0.5px;
	}

	.site-title:hover {
		text-decoration: none;
	}

	.nav-links {
		display: flex;
		gap: 1.5rem;
	}

	.nav-links a {
		color: var(--accent-color);
		text-decoration: none;
		font-weight: 500;
		font-size: 1rem;
		transition: color 0.2s ease;
	}

	.nav-links a:hover {
		color: var(--accent-color);
	}
</style>
